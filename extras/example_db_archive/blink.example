EXCLUDE=Arduino UNO

++--HEADER--++

/*
 * Created on 2023.July.30
 *
 * Copyright (c) 2023 - Daniel Hajnal
 * hajnal.daniel96@gmail.com
 * This file is part of the Commander-API project.
 * Modified {{ YEAR }}.{{ MONTH }}.{{ DAY }}
 *
 * This is a simple example, that demonstrates how
 * to use the base functionality of th Commander-API.
*/

++--INCLUDES--++

// Necessary includes
#include "Commander-API.hpp"
#include "Commander-IO.hpp"
#include "Commander-API-Commands.hpp"

++--GLOBAL_VARIABLES--++

// We have to create an object from Commander class.
Commander commander;

Commander::API_t API_tree[] = {
    API_ELEMENT_PINMODE,
    API_ELEMENT_DIGITALREAD,
    API_ELEMENT_DIGITALWRITE
};

++--FUNCTION_PROTOTYPES--++

++--SETUP--++

// There is an option to attach a debug channel to Commander.
// It can be handy to find any problems during the initialization
// phase. In this example, we will use {{ channel }} for this.
commander.attachDebugChannel( &{{ channel }} );

// At start, Commander does not know anything about our commands.
// We have to attach the API_tree array from the previous steps
// to Commander to work properly.
commander.attachTree( API_tree );

// After we attached the API_tree, Commander has to initialize
// itself for the fastest runtime possible. It creates a balanced
// binary tree from the API_tree to boost the search speed.
// This part uses some recursion, to make the code space small.
// But recursion is a bit stack hungry, so please initialize
// Commander at the beginning of your code to prevent stack-overflow.
commander.init();

{{ channel }}.println();
{{ channel }}.println( __CONST_TXT__( "---- Init Finished ----" ) );
{{ channel }}.println();

// List all the available commands.
{{ channel }}.println( __CONST_TXT__( "Executing 'help -d' command:" ) );
commander.execute( "help -d", &{{ channel }} );
{{ channel }}.println();

// Set pin 13 to output. Usually the LED is on this pin.
{{ channel }}.println( __CONST_TXT__( "Executing 'pinMode -p 13 -o' command:" ) );
commander.execute( "pinMode -p 13 -o", &{{ channel }} );
{{ channel }}.println();

++--LOOP--++

// Set pin 13 to logic high. It will turn on the built in LED on most boards.
{{ channel }}.println( __CONST_TXT__( "Executing 'digitalWrite -p 13 -h' command:" ) );
commander.execute( "digitalWrite -p 13 -h", &{{ channel }} );
{{ channel }}.println();

// Read the state of pin 13.
{{ channel }}.println( __CONST_TXT__( "Executing 'digitalRead -p 13' command:" ) );
commander.execute( "digitalRead -p 13", &{{ channel }} );
{{ channel }}.println();

// Delay one seconds.
delay( 1000 );

// Set pin 13 to logic low. It will turn off the built in LED on most boards.
{{ channel }}.println( __CONST_TXT__( "Executing 'digitalWrite -p 13 -l' command:" ) );
commander.execute( "digitalWrite -p 13 -h", &{{ channel }} );
{{ channel }}.println();

// Read the state of pin 13.
{{ channel }}.println( __CONST_TXT__( "Executing 'digitalRead -p 13' command:" ) );
commander.execute( "digitalRead -p 13", &{{ channel }} );
{{ channel }}.println();

// Delay one seconds.
delay( 1000 );

++--FUNCTION_IMPLEMENTATIONS--++
